<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FunnyChat ðŸ’• - Sohbet</title>
<script src="https://fpyf8.com/88/tag.min.js" data-zone="182894" async data-cfasync="false"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: #fbe9ef;
  margin: 0;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* Ana kap */
.chat-container {
  width: 370px;
  max-width: 100%;
  height: 640px;
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 0 20px rgba(255,182,193,0.5);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* BaÅŸlÄ±k */
.header {
  background: #ffb6c1;
  color: white;
  padding: 10px 14px;
  display: flex;
  align-items: center;
  gap: 10px;
  justify-content: space-between;
}

.header-left {
  display: flex;
  align-items: center;
  gap: 10px;
}

.header img {
  width: 45px;
  height: 45px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid #fff;
}

.header-title {
  font-weight: bold;
}

.header small {
  color: #fff;
}

.online-dot {
  width: 8px;
  height: 8px;
  background: #ff69b4;
  border-radius: 50%;
  display: inline-block;
  margin-left: 5px;
}

/* Sohbet alanÄ± */
.chat-box {
  flex: 1;
  padding: 12px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  background: #fdeef4;
}

.message {
  max-width: 80%;
  padding: 8px 10px;
  margin: 6px 0;
  border-radius: 8px;
  position: relative;
  font-size: 14px;
  line-height: 1.4;
  word-wrap: break-word;
}

.sent {
  background: #ffe6ef;
  align-self: flex-end;
  color: #000;
  border-bottom-right-radius: 0;
}

.received {
  background: #fff;
  align-self: flex-start;
  color: #000;
  border-bottom-left-radius: 0;
}

.status {
  font-size: 10px;
  color: gray;
  text-align: right;
  margin-top: 2px;
}

/* GiriÅŸ alanÄ± */
.input-area {
  display: flex;
  align-items: center;
  background: #f9dfe7;
  padding: 8px;
  gap: 8px;
}

.input-area input {
  flex: 1;
  padding: 10px 14px;
  border: none;
  border-radius: 25px;
  outline: none;
  font-size: 14px;
  background: #fff;
  color: #000;
}

.input-area input::placeholder {
  color: #999;
}

.input-area button {
  background: none;
  border: none;
  color: #ff69b4;
  font-size: 22px;
  cursor: pointer;
  padding: 6px 10px;
  transition: transform 0.2s ease;
}

.input-area button:hover {
  transform: scale(1.1);
}

/* YazÄ±yor baloncuÄŸu */
.typing-bubble {
  display: flex;
  align-items: center;
  background: #fff;
  border-radius: 15px;
  padding: 6px 12px;
  margin: 6px 0;
  width: 60px;
  justify-content: space-around;
}

.typing-dot {
  width: 6px;
  height: 6px;
  background: gray;
  border-radius: 50%;
  animation: blink 1.2s infinite;
}

.typing-dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes blink {
  0%,80%,100% { opacity: 0.2; transform: translateY(0); }
  40% { opacity: 1; transform: translateY(-2px); }
}

/* Sesli mesaj */
.voice-message {
  display: flex;
  align-items: center;
  gap: 10px;
  background: #fff;
  padding: 10px;
  border-radius: 10px;
  color: #000;
}

.voice-message i {
  font-size: 20px;
  color: #ff69b4;
  cursor: pointer;
}

.voice-wave {
  display: flex;
  gap: 2px;
  align-items: flex-end;
  height: 20px;
}

.wave-bar {
  width: 3px;
  height: 8px;
  background: #ff69b4;
  border-radius: 2px;
  animation: waveAnim 1.2s ease-in-out infinite;
}

.wave-bar:nth-child(2) { animation-delay: 0.1s; }
.wave-bar:nth-child(3) { animation-delay: 0.2s; }
.wave-bar:nth-child(4) { animation-delay: 0.3s; }
.wave-bar:nth-child(5) { animation-delay: 0.4s; }

@keyframes waveAnim {
  0%,100% { height: 8px; }
  50% { height: 18px; }
}

.voice-duration {
  font-size: 12px;
  color: gray;
}
</style>
</head>
<body>
<div class="chat-container">
  <div class="header">
    <div class="header-left">
      <img src="melisa.jpg" alt="Melisa">
      <div>
        <div class="header-title">Melisa TatlÄ± ðŸ’•</div>
        <small id="melisaStatus">Ã§evrimiÃ§i <span class="online-dot"></span></small>
      </div>
    </div>
    <strong>FunnyChat ðŸ’¬</strong>
  </div>

  <div class="chat-box" id="chat-box"></div>

  <div class="input-area">
    <input type="text" id="userInput" placeholder="Mesaj yaz..." oninput="toggleSendButton()">
    <button id="actionButton" onclick="sendMessage()">
      <i id="buttonIcon" class="fa-solid fa-microphone"></i>
    </button>
  </div>
</div>

<script>
const chatBox = document.getElementById('chat-box');
const userInput = document.getElementById('userInput');
const actionButton = document.getElementById('actionButton');
const buttonIcon = document.getElementById('buttonIcon');
const melisaStatus = document.getElementById('melisaStatus');

let messageCount = 0;
let melisaAvailable = true;

const responses = [
  "meraba nasÄ±sn cnm ðŸ˜Š",
  "hmm bekle bi dÃ¼ÅŸÃ¼nyom sn biÅŸey dicek gibisin",
  "tamam ÅŸmdi dinle bakalÄ±m ðŸŽ§"
];

function messUpText(text) {
  const mistakes = {
    "Ã§ok": "Ã§k", "tamam": "tm", "sen": "sn", "sende": "snde", "bilmiyorum": "bilmiyom",
    "ÅŸimdi": "ÅŸmdi", "evet": "evt", "hayÄ±r": "hyr", "biraz": "bi", "deÄŸil": "diil",
    "gÃ¼zel": "gzl", "bak": "bk", "nasÄ±lsÄ±n": "nasÄ±sn"
  };
  let words = text.split(" ");
  return words.map(w => mistakes[w] || w).join(" ");
}

function scrollToBottom() { chatBox.scrollTop = chatBox.scrollHeight; }

function toggleSendButton() {
  const hasText = userInput.value.trim().length > 0;
  buttonIcon.className = hasText ? "fa-solid fa-paper-plane" : "fa-solid fa-microphone";
  actionButton.style.color = hasText ? "#ff69b4" : "#ff69b4";
}

function formatTime(seconds) {
  const m = Math.floor(seconds / 60);
  const s = Math.floor(seconds % 60).toString().padStart(2, "0");
  return `${m}:${s}`;
}

function sendMessage() {
  const text = userInput.value.trim();
  if (!text) return;

  messageCount++;

  const msg = document.createElement('div');
  msg.className = 'sent message';
  msg.innerHTML = `${text}<div class="status">âœ“âœ“</div>`;
  chatBox.appendChild(msg);
  userInput.value = '';
  toggleSendButton();
  scrollToBottom();

  if (!melisaAvailable) return;

  const typingDelay = 10000 + Math.random() * 5000;
  setTimeout(() => {
    const typingBubble = document.createElement('div');
    typingBubble.className = 'typing-bubble received';
    typingBubble.innerHTML = `
      <div class="typing-dot"></div>
      <div class="typing-dot"></div>
      <div class="typing-dot"></div>`;
    chatBox.appendChild(typingBubble);
    scrollToBottom();

    const responseDelay = 15000 + Math.random() * 10000;
    setTimeout(() => {
      typingBubble.remove();

      if (messageCount === 3) {
        const voiceDiv = document.createElement('div');
        voiceDiv.className = 'received message';
        voiceDiv.innerHTML = `
          <div class="voice-message">
            <i class="fa-solid fa-play" id="playBtn"></i>
            <div class="voice-wave" id="waveAnim">
              <div class="wave-bar"></div>
              <div class="wave-bar"></div>
              <div class="wave-bar"></div>
              <div class="wave-bar"></div>
              <div class="wave-bar"></div>
            </div>
            <span class="voice-duration" id="voiceTime">0:00</span>
            <audio id="voiceAudio" src="melisa2.mp3"></audio>
          </div>`;
        chatBox.appendChild(voiceDiv);
        scrollToBottom();

        const audio = voiceDiv.querySelector("#voiceAudio");
        const playBtn = voiceDiv.querySelector("#playBtn");
        const waveBars = voiceDiv.querySelectorAll(".wave-bar");
        const timeLabel = voiceDiv.querySelector("#voiceTime");

        playBtn.addEventListener("click", () => {
          if (audio.paused) {
            audio.play();
            playBtn.classList.replace("fa-play", "fa-pause");
            waveBars.forEach(b => b.style.animationPlayState = "running");
          } else {
            audio.pause();
            playBtn.classList.replace("fa-pause", "fa-play");
            waveBars.forEach(b => b.style.animationPlayState = "paused");
          }
        });

        audio.addEventListener("timeupdate", () => {
          timeLabel.textContent = formatTime(audio.currentTime);
        });

        audio.addEventListener("ended", () => {
          playBtn.classList.replace("fa-pause", "fa-play");
          waveBars.forEach(b => b.style.animationPlayState = "paused");

          melisaStatus.innerHTML = "Ã§evrimdÄ±ÅŸÄ±";
          melisaStatus.style.color = "#ccc";

          let minutes = 0;
          setInterval(() => {
            minutes++;
            melisaStatus.innerHTML = minutes === 1 
              ? "1 dakika Ã¶nce aktifti" 
              : `${minutes} dakika Ã¶nce aktifti`;
          }, 60000);
        });

        audio.play();
        playBtn.classList.replace("fa-play", "fa-pause");

        melisaAvailable = false;
        setTimeout(() => { melisaAvailable = true; }, 3600000);

      } else {
        const melisaMsg = document.createElement('div');
        melisaMsg.className = 'received message';
        let rawReply = responses[Math.min(messageCount - 1, 2)];
        melisaMsg.textContent = messUpText(rawReply);
        chatBox.appendChild(melisaMsg);
        scrollToBottom();
      }
      msg.querySelector('.status').style.color = '#ff69b4';
    }, responseDelay);
  }, typingDelay);
}
</script>
</body>
</html>
